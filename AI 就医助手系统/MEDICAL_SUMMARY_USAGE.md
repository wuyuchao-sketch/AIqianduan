# 病例总结功能使用说明

## 功能概述

在医生端界面中集成了AI病例总结功能，通过调用MedicalSummaryController接口，为医生提供智能化的病例分析和总结服务。

## 主要功能

### 1. AI病例总结面板
- **位置**: 医生端界面中间区域，患者详情下方
- **功能**: 显示和生成患者的AI病例总结
- **接口**: 调用MedicalSummaryController相关接口

### 2. API连接测试
- **位置**: 患者列表区域的"测试API连接"按钮
- **功能**: 检查后端API是否正常工作
- **接口**: 调用MedicalSummaryController的getAllSummaries接口

## 使用流程

### 步骤1: 选择患者
1. 在左侧患者列表中选择一个患者
2. 或点击"扫描患者就诊码"按钮模拟扫码选择患者

### 步骤2: 测试API连接（可选）
1. 点击"测试API连接"按钮
2. 系统会检查后端API是否正常工作
3. 显示当前数据库中的病历总结数量

### 步骤3: 生成病例总结
1. 在AI病例总结面板中，点击"生成病例总结"按钮
2. 系统会调用AI生成接口进行流式生成
3. 实时显示生成过程和结果

### 步骤4: 查看和管理总结
1. 生成完成后可以查看详细的病例总结内容
2. 包括：症状详情、生命体征、既往病史、当前用药
3. 可以重新生成或导出到HIS系统

## 接口说明

### MedicalSummaryController接口
- `GET /api/medical-summary/visit/{visitId}` - 获取病历总结
- `POST /api/medical-summary/generate/{visitId}` - 生成病历总结（流式）
- `GET /api/medical-summary/all` - 获取所有病历总结
- `POST /api/medical-summary/create` - 手动创建病历总结

## 技术实现

### 前端组件
- `MedicalSummaryPanel.tsx` - 病例总结主面板组件
- `DoctorView.tsx` - 医生端主界面（已集成病例总结功能）
- `medicalAPI.ts` - API调用工具函数

### 关键特性
1. **流式生成**: 支持实时显示AI生成过程
2. **错误处理**: 完善的错误提示和重试机制
3. **响应式设计**: 支持无障碍模式和不同屏幕尺寸

## 注意事项

1. **后端服务**: 确保后端Spring Boot服务在localhost:8070端口运行
2. **数据库**: 需要配置相应的数据库连接
3. **AI服务**: MedicalSummaryController中的AI生成功能需要配置相应的AI服务
4. **转录数据**: 需要先有转录数据才能生成病例总结

## 故障排除

### 常见问题
1. **API连接失败**: 检查后端服务是否启动，端口是否正确
2. **生成失败**: 查看浏览器控制台错误信息，检查AI服务配置
3. **数据不显示**: 确认数据库连接正常，检查visitId是否正确

### 调试工具
- 浏览器开发者工具网络面板
- 后端日志输出
- "测试API连接"功能进行快速诊断